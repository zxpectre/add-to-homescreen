!function(o,s,t){var e="com.love2dev.addtohome",i=localStorage.getItem(e);if(!i||!i.added){o.onbeforeinstallprompt&&o.addEventListener("beforeinstallprompt",function(o){o.preventDefault(),p=o}),o.onappinstalled&&o.addEventListener("appinstalled",function(o){n.doLog("a2hs","installed"),i.added=!0,n.updateSession(),this.options.onInstall&&this.options.onInstall.call(this)});var n,a,r={},l={title:"Install this PWA?",src:"imgs/pwa-logo-50x50.png",cancelMsg:"Not Now",installMsg:"Install"};u.defaults={appID:e,appName:"Progressive Web App",debug:!1,logging:!1,modal:!1,mandatory:!1,autostart:!0,skipFirstVisit:!1,minSessions:0,startDelay:1,lifespan:15,displayPace:1440,displayNextPrime:!1,mustShowCustomPrompt:!1,maxDisplayCount:0,validLocation:[],onInit:null,onShow:null,onAdd:null,onInstall:null,onCancel:null,customCriteria:null,manualPrompt:null,customPrompt:{},athWrapper:".ath-container",athGuidance:"ath-guidance",showClasses:["animated","d-flex"],showClass:"d-flex",hideClass:"d-none",promptDlg:{title:".ath-banner-title",body:".ath-banner",logo:".ath-prompt-logo",cancel:".btn-cancel",install:".btn-install",action:{ok:"Install",cancel:"Not Now"}},prompt:{native:{targetUrl:t,showClasses:["fadeInUp","right-banner"],action:{ok:"Install",cancel:"Not Now"}},edge:{targetUrl:t,showClasses:["edge-wrapper","animated","fadeIn","d-block","right-banner"],imgs:[{src:"imgs/edge-a2hs-icon.png",alt:"Tap the Add to Homescreen Icon"}]},chromium:{targetUrl:t,showClasses:["chromium-wrapper","animated","fadeIn","d-block","right-banner"],imgs:[{src:"imgs/chromium-guidance.png",alt:"Tap the Add to Homescreen Icon"}]},iphone:{targetUrl:t,showClasses:["iphone-wrapper","animated","fadeIn","d-block"],imgs:[{src:"imgs/ios-safari-share-button-highlight.jpg",alt:"Tap the Share Icon"},{src:"imgs/iphone-a2hs-swipe-to-right.jpg",classes:["animated","fadeIn","overlay-1","delay-2s"],alt:"Swipe to the right"},{src:"imgs/iphone-a2hs-icon-highlight.jpg",classes:["animated","fadeIn","overlay-2","delay-4s"],alt:"Tap the Add to Homescreen Icon"}]},ipad:{targetUrl:t,showClasses:["ipad-wrapper","animated","fadeInUp","d-block"],imgs:[{src:"imgs/safari-ipad-share-a2hs-right.jpg",alt:"Tap the Add to Homescreen Icon"}]},firefox:{targetUrl:t,showClasses:["firefox-wrapper","animated","fadeIn","d-block"],imgs:[{src:"imgs/firefox-a2hs-icon.png",alt:"Tap the Add to Homescreen Icon"}]},samsung:{targetUrl:t,showClasses:["samsung-wrapper","animated","fadeIn","d-block"],imgs:[{src:"imgs/samsung-internet-a2hs-icon.png",alt:"Tap the Add to Homescreen Icon"}]},opera:{targetUrl:t,showClasses:["opera-home-screen-wrapper","animated","fadeIn","d-block"],imgs:[{src:"imgs/opera-add-to-homescreen.png",alt:"Tap the Add to Homescreen Icon"}]}}},a=o.navigator.userAgent,r.isIDevice=/iphone|ipod|ipad/i.test(a),r.isSamsung=/Samsung/i.test(a),r.isFireFox=/Firefox/i.test(a),r.isOpera=/opr/i.test(a),r.isEdge=/edg/i.test(a),r.isFireFox&&(r.isFireFox=/android/i.test(a)),r.isOpera&&(r.isOpera=/android/i.test(a)),r.isChromium="onbeforeinstallprompt"in o,r.isInWebAppiOS=!0===o.navigator.standalone,r.isInWebAppChrome=o.matchMedia("(display-mode: standalone)").matches,r.isMobileSafari=r.isIDevice&&a.indexOf("Safari")>-1&&a.indexOf("CriOS")<0,r.isStandalone=r.isInWebAppiOS||r.isInWebAppChrome,r.isiPad=r.isMobileSafari&&a.indexOf("iPad")>-1,r.isiPhone=r.isMobileSafari&&-1===a.indexOf("iPad"),r.isCompatible=r.isChromium||r.isMobileSafari||r.isSamsung||r.isFireFox||r.isOpera;var p,d={lastDisplayTime:0,returningVisitor:!1,displayCount:0,optedout:!1,added:!1,sessions:0,nextSession:0};i=i?JSON.parse(i):d,u.removeSession=function(o){localStorage.removeItem(o||u.defaults.appID)},u.doLog=function(o){this.options.logging&&console.log(o)},r.cancelPrompt=function(o){return o.preventDefault(),n.options.onCancel&&n.options.onCancel(),r.closePrompt(),!1},r.closePrompt=function(){var o=s.querySelector(n.options.athWrapper);o&&o.classList.remove(...n.options.showClasses)},r.handleInstall=function(o){return n.options.onInstall&&n.options.onInstall(),!p||n.options.debug&&"native"!==m()?function(o){var t,e=m(o),i=s.querySelector(n.options.athWrapper);if(i)if(n.autoHideTimer&&clearTimeout(n.autoHideTimer),!o&&"native"===e&&p)r.closePrompt(),h();else{var a=Object.assign({},l,n.options.customPrompt,n.options.prompt[e]);if(a.targetUrl)location.replace(a.targetUrl);else{var d=i.querySelector(n.options.promptDlg.body);if(a.imgs&&a.imgs.length>0){d.innerHTML="",d.classList.add(n.options.athGuidance);for(var c=0;c<a.imgs.length;c++){var u=new Image;u.src=a.imgs[c].src,u.alt=a.imgs[c].alt,a.imgs[c].classes&&u.classList.add(...a.imgs[c].classes),u.classList.add(n.options.showClass),d.appendChild(u)}}(0===(t=i.getBoundingClientRect()).width||0===t.height)&&(i.classList.add(...a.showClasses),i.classList.remove(n.options.hideClass));var g=n.options.lifespan>=10?n.options.lifespan:10;n.autoHideTimer=setTimeout(n.autoHide,1e3*g)}}}(!0):(r.closePrompt(),h()),!1},u.Class=function(o){(this.doLog=u.doLog,this.options=Object.assign({},u.defaults,o),"serviceWorker"in navigator)&&(s.querySelector("[rel='manifest']")||(r.isCompatible=!1),navigator.serviceWorker.getRegistration().then(g),function(o){for(var s in o)if(o.hasOwnProperty(s)){var t=o[s].targetUrl;t&&c.push(t)}}(this.options.prompt))};var c=[];u.Class.prototype={_canPrompt:t,canPrompt:function(){if(this._canPrompt!==t)return this._canPrompt;if(this._canPrompt=!1,null!==n.options.customCriteria||n.options.customCriteria!==t){if(!("function"==typeof n.options.customCriteria?n.options.customCriteria():!!n.options.customCriteria))return this.doLog("Add to homescreen: not displaying callout because a custom criteria was not met."),!1}if(!("serviceWorker"in navigator))return this.doLog("Add to homescreen: not displaying callout because service workers are not supported"),!1;if(!r.isCompatible)return this.doLog("Add to homescreen: not displaying callout because device not supported"),!1;if(Date.now()-i.lastDisplayTime<6e4*this.options.displayPace)return this.doLog("Add to homescreen: not displaying callout because displayed recently"),!1;if(this.options.maxDisplayCount&&i.displayCount>=this.options.maxDisplayCount)return this.doLog("Add to homescreen: not displaying callout because displayed too many times already"),!1;for(var o=!this.options.validLocation.length,e=this.options.validLocation.length;e--;)if(this.options.validLocation[e].test(s.location.href)){o=!0;break}if(!o)return this.doLog("Add to homescreen: not displaying callout because not a valid location"),!1;var a=!1;for(e=c.length;e--;)if(s.location.href.indexOf(c[e])>-1){a=!0;break}return a?(this.doLog("Add to homescreen: not displaying callout because this is a guidance URL"),!1):i.sessions<this.options.minSessions?(this.doLog("Add to homescreen: not displaying callout because not enough visits"),!1):this.options.nextSession&&this.options.nextSession>0&&i.sessions>=this.options.nextSession?(this.doLog("Add to homescreen: not displaying callout because waiting on session "+this.options.nextSession),!1):i.optedout?(this.doLog("Add to homescreen: not displaying callout because user opted out"),!1):i.added?(this.doLog("Add to homescreen: not displaying callout because already added to the homescreen"),!1):r.isStandalone?(i.added||(i.added=!0,this.updateSession(),this.options.onAdd&&this.options.onAdd.call(this)),this.doLog("Add to homescreen: not displaying callout because in standalone mode"),!1):!i.returningVisitor&&(i.returningVisitor=!0,this.updateSession(),this.options.skipFirstVisit)?(this.doLog("Add to homescreen: not displaying callout because skipping first visit"),!1):(this._canPrompt=!0,!0)},show:function(o){this.shown?this.doLog("Add to homescreen: not displaying callout because already shown on screen"):(this.shown=!0,i.lastDisplayTime=Date.now(),i.displayCount++,n.options.displayNextPrime&&(i.nextSession=function(o){for(;;){var s=!0;isNaN(o)&&(o=0),o+=1;for(var t=Math.sqrt(o),e=2;e<=t;e++)if(o%e==0){s=!1;break}if(s)return o}}(i.sessions)),n.updateSession(),"interactive"===s.readyState||"complete"===s.readyState?n._delayedShow():s.onreadystatechange=function(){"complete"===s.readyState&&n._delayedShow()})},_delayedShow:function(o){setTimeout(this._show.bind(this),1e3*this.options.startDelay+500)},_show:function(){if(n.canPrompt()){if(p&&!n.options.mustShowCustomPrompt)h();else{var o=m(),t=s.querySelector(n.options.athWrapper);if(t&&!i.optedout){t.classList.remove(n.options.hideClass);var e=Object.assign({},l,n.options.customPrompt,n.options.prompt[o]);e.showClasses?e.showClasses=e.showClasses.concat(n.options.showClasses):e.showClasses=n.options.showClasses,t.classList.add(...e.showClasses);var a=t.querySelector(n.options.promptDlg.title),d=t.querySelector(n.options.promptDlg.logo),c=t.querySelector(n.options.promptDlg.cancel),u=t.querySelector(n.options.promptDlg.install);a&&e.title&&(a.innerText=e.title),d&&e.src&&(d.src=e.src,d.alt=e.title||"Install PWA"),u&&(u.addEventListener("click",r.handleInstall),u.classList.remove(n.options.hideClass),u.innerText=e.installMsg?e.installMsg:e.action&&e.action.ok?e.action.ok:n.options.promptDlg.action.ok),c&&(c.addEventListener("click",r.cancelPrompt),c.classList.remove(n.options.hideClass),c.innerText=e.cancelMsg?e.cancelMsg:e.action&&e.action.cancel?e.action.cancel:n.options.promptDlg.action.cancel)}this.options.lifespan&&this.options.lifespan>0&&(n.autoHideTimer=setTimeout(this.autoHide,1e3*this.options.lifespan))}this.options.onShow&&this.options.onShow.call(this)}},trigger:function(){this._show()},autoHide:function(){var o=m(),t=s.querySelector(n.options.athWrapper);if(t){var e=n.options.prompt[o];e.showClasses=e.showClasses.concat(n.options.showClasses),t.classList.remove(...e.showClasses),t.classList.add(n.options.hideClass)}},updateSession:function(){localStorage.setItem(this.options.appID,JSON.stringify(i))},clearSession:function(){i=d,this.updateSession()},optOut:function(){i.optedout=!0,this.updateSession()},optIn:function(){i.optedout=!1,this.updateSession()},clearDisplayCount:function(){i.displayCount=0,this.updateSession()}},o.addToHomescreen=u}function h(){return p.prompt().then(function(o){return p.userChoice}).then(function(o){i.added="accepted"===o.outcome,i.added?(n.doLog("User accepted the A2HS prompt"),n.options.onAdd&&n.options.onAdd()):(n.options.onCancel&&n.options.onCancel(),i.optedout=!0,n.doLog("User dismissed the A2HS prompt")),n.updateSession(),p=null}).catch(function(o){n.doLog(o.message),o.message.indexOf("user gesture")>-1?(n.options.mustShowCustomPrompt=!0,n._delayedShow()):o.message.indexOf("The app is already installed")>-1&&(i.added=!0,n.updateSession())})}function m(o){return n.options.debug&&"string"==typeof n.options.debug?n.options.debug:r.isChromium&&o===t&&!o?"native":r.isFireFox?"firefox":r.isiPad?"ipad":r.isiPhone?"iphone":r.isOpera?"opera":r.isSamsung?"samsung":r.isEdge?"edge":r.isChromium?"chromium":""}function u(o){return n=n||new u.Class(o)}function g(s){n.sw=s,n.sw||(r.isCompatible=!1),i.sessions+=1,n.updateSession(),n.options&&n.options.debug&&void 0===n.options.logging&&(n.options.logging=!0),n.options.mandatory=n.options.mandatory&&("standalone"in o.navigator||n.options.debug),n.options.modal=n.options.modal||n.options.mandatory,n.options.mandatory&&(n.options.startDelay=-.5),n.options.debug&&(r.isCompatible=!0),n.options.onInit&&n.options.onInit.call(n),n.options.autostart&&(n.doLog("Add to homescreen: autostart displaying callout"),n.show())}}(window,document);